<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>NeverLAN CTF 2020 Write-up | AdelaideB9 Blog</title><meta name=keywords content><meta name=description content="Browser Bias This challenge gives us very little information, just a url to a site that tells us Sorry, this site is only optimized for browsers that run on commodo 64. However, this also narrows our focus down to a singular goal - trying to convince the website that we are accessing it from a whatever a &lsquo;commodo 64&rsquo; is.
The first thing we need to know is how the browser can determine what type of client is making a request to it."><meta name=author content="javad"><link rel=canonical href=https://blog.adelaideb9.com/posts/2020/neverlan/><link crossorigin=anonymous href=/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe+FVUFzPh7U=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://blog.adelaideb9.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.adelaideb9.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.adelaideb9.com/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.adelaideb9.com/apple-touch-icon.png><link rel=mask-icon href=https://blog.adelaideb9.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css integrity=sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js integrity=sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4 crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js integrity=sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa crossorigin=anonymous onload='renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"\\[",right:"\\]",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1}]})'></script><meta property="og:title" content="NeverLAN CTF 2020 Write-up"><meta property="og:description" content="Browser Bias This challenge gives us very little information, just a url to a site that tells us Sorry, this site is only optimized for browsers that run on commodo 64. However, this also narrows our focus down to a singular goal - trying to convince the website that we are accessing it from a whatever a &lsquo;commodo 64&rsquo; is.
The first thing we need to know is how the browser can determine what type of client is making a request to it."><meta property="og:type" content="article"><meta property="og:url" content="https://blog.adelaideb9.com/posts/2020/neverlan/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-02-08T14:30:10+00:00"><meta property="article:modified_time" content="2020-02-08T14:30:10+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="NeverLAN CTF 2020 Write-up"><meta name=twitter:description content="Browser Bias This challenge gives us very little information, just a url to a site that tells us Sorry, this site is only optimized for browsers that run on commodo 64. However, this also narrows our focus down to a singular goal - trying to convince the website that we are accessing it from a whatever a &lsquo;commodo 64&rsquo; is.
The first thing we need to know is how the browser can determine what type of client is making a request to it."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.adelaideb9.com/posts/"},{"@type":"ListItem","position":2,"name":"NeverLAN CTF 2020 Write-up","item":"https://blog.adelaideb9.com/posts/2020/neverlan/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"NeverLAN CTF 2020 Write-up","name":"NeverLAN CTF 2020 Write-up","description":"Browser Bias This challenge gives us very little information, just a url to a site that tells us Sorry, this site is only optimized for browsers that run on commodo 64. However, this also narrows our focus down to a singular goal - trying to convince the website that we are accessing it from a whatever a \u0026lsquo;commodo 64\u0026rsquo; is.\nThe first thing we need to know is how the browser can determine what type of client is making a request to it.","keywords":[],"articleBody":"Browser Bias This challenge gives us very little information, just a url to a site that tells us Sorry, this site is only optimized for browsers that run on commodo 64. However, this also narrows our focus down to a singular goal - trying to convince the website that we are accessing it from a whatever a ‘commodo 64’ is.\nThe first thing we need to know is how the browser can determine what type of client is making a request to it. It turns out, a site can only determine this through the User-Agent header. We can manipulate this information in a variety of ways - like with browser extensions or on some browsers using the Developer Tools - but for the sake of controlling exactly what headers are passed over we made this handy little python function.\n{% gist 889226036803bab244ae41b127dc0ab3 %}\nNext we have to figure out what our user-agent string should actually be. If we pass ‘commodo 64’ as the user-agent parameter of our function nothing changes. Googling commodo 64, we get results for the 1982 computer, The Commodore 64, but making that the header doesn’t work either. The part of the challenge we’re forgeting is that the site requires browsers that run on commodo 64. We need to find the header of a browser that works on the Commodore 64 …\n… here’s one! Hyperlink/2.5e (Commodore 64)\nPut that into our function and we get Welcome fellow c64 user. flag{8b1t_w3b}\nRobot Talk We found the best way to comunicate with challenges.neverlanctf.com:1120 was through Telnet!\nHere’s the handy script we made …\n{% gist 5edbe8981351b9213bad90cd38135a0d %}\n… and here’s the outputted flag flag{Ant1_hum4n}\nBitsnBytes Given the ‘programming’ category, the title, and the fact that we are only linked to an image with green and gray squres, we figured that each colour represented a bit (1 or 0 in binary) and we had to write a script that would translate it.\n{% gist 24c0d9afe556dba4f84e383b62d4469b %}\nHere, each green square is decoded as a zero, and each gray is a one. Since this is an svg, which is conveniently a file type where infomation is stored in plain text, we didn’t need to bring out any python image-processing libraries. Then we would convert the binary string to plain text.\nThe problem was, we weren’t getting the flag - we were getting something like this time hash:076a1b24abb4870fc5eb892de796b5b32642f95664c04ff0d9b2b96c58a0b. The trick to this challenge was that the server only spits out the image of the encoded flag at hourly intervals, during the minute after the clock has shifted to the new hour. Once we got the right image we also got Now you've got it! Here's your flag: flag{its_all_ab0ut_timing}.\n","wordCount":"447","inLanguage":"en","datePublished":"2020-02-08T14:30:10Z","dateModified":"2020-02-08T14:30:10Z","author":{"@type":"Person","name":"javad"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.adelaideb9.com/posts/2020/neverlan/"},"publisher":{"@type":"Organization","name":"AdelaideB9 Blog","logo":{"@type":"ImageObject","url":"https://blog.adelaideb9.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.adelaideb9.com/ accesskey=h title="AdelaideB9 Blog (Alt + H)">AdelaideB9 Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://blog.adelaideb9.com/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://blog.adelaideb9.com/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://blog.adelaideb9.com/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://blog.adelaideb9.com/>Home</a>&nbsp;»&nbsp;<a href=https://blog.adelaideb9.com/posts/>Posts</a></div><h1 class=post-title>NeverLAN CTF 2020 Write-up</h1><div class=post-meta><span title='2020-02-08 14:30:10 +0000 UTC'>February 8, 2020</span>&nbsp;·&nbsp;javad</div></header><div class=post-content><h2 id=browser-bias>Browser Bias<a hidden class=anchor aria-hidden=true href=#browser-bias>#</a></h2><p>This challenge gives us very little information, just a url to a site that tells us <code>Sorry, this site is only optimized for browsers that run on commodo 64</code>. However, this also narrows our focus down to a singular goal - trying to convince the website that we are accessing it from a whatever a &lsquo;commodo 64&rsquo; is.</p><p>The first thing we need to know is how the browser can determine what type of client is making a request to it. It turns out, a site can only determine this through the <code>User-Agent</code> header. We can manipulate this information in a variety of ways - like with browser extensions or on some browsers using the Developer Tools - but for the sake of controlling exactly what headers are passed over we made this handy little python function.</p><p>{% gist 889226036803bab244ae41b127dc0ab3 %}</p><p>Next we have to figure out what our user-agent string should actually be. If we pass &lsquo;commodo 64&rsquo; as the user-agent parameter of our function nothing changes. Googling commodo 64, we get results for the 1982 computer, The Commodore 64, but making that the header doesn&rsquo;t work either. The part of the challenge we&rsquo;re forgeting is that the site requires <code>browsers that run on commodo 64</code>. We need to find the header of a browser that works on the Commodore 64 &mldr;</p><p>&mldr; here&rsquo;s one! <code>Hyperlink/2.5e (Commodore 64)</code></p><p>Put that into our function and we get <code>Welcome fellow c64 user. flag{8b1t_w3b}</code></p><h2 id=robot-talk>Robot Talk<a hidden class=anchor aria-hidden=true href=#robot-talk>#</a></h2><p>We found the best way to comunicate with <a href=challenges.neverlanctf.com:1120 title=challenges.neverlanctf.com:1120>challenges.neverlanctf.com:1120</a> was through Telnet!</p><p>Here&rsquo;s the handy script we made &mldr;</p><p>{% gist 5edbe8981351b9213bad90cd38135a0d %}</p><p>&mldr; and here&rsquo;s the outputted flag <code>flag{Ant1_hum4n}</code></p><h2 id=bitsnbytes>BitsnBytes<a hidden class=anchor aria-hidden=true href=#bitsnbytes>#</a></h2><p>Given the &lsquo;programming&rsquo; category, the title, and the fact that we are only linked to an image with green and gray squres, we figured that each colour represented a bit (<code>1</code> or <code>0</code> in binary) and we had to write a script that would translate it.</p><p>{% gist 24c0d9afe556dba4f84e383b62d4469b %}</p><p>Here, each green square is decoded as a zero, and each gray is a one. Since this is an svg, which is conveniently a file type where infomation is stored in plain text, we didn&rsquo;t need to bring out any python image-processing libraries. Then we would convert the binary string to plain text.</p><p>The problem was, we weren&rsquo;t getting the flag - we were getting something like this <code>time hash:076a1b24abb4870fc5eb892de796b5b32642f95664c04ff0d9b2b96c58a0b</code>. The trick to this challenge was that the server only spits out the image of the encoded flag at hourly intervals, during the minute after the clock has shifted to the new hour. Once we got <a href=/assets/uploads/php.svg>the right image</a> we also got <code>Now you've got it! Here's your flag: flag{its_all_ab0ut_timing}</code>.</p></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://blog.adelaideb9.com/>AdelaideB9 Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>