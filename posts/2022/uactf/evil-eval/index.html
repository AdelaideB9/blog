<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Evil Eval - UACTF 2022 | AdelaideB9 Blog</title><meta name=keywords content><meta name=description content="Made a cool internet calculator for all your maths needs. Well, some of your maths needs."><meta name=author content="javad"><link rel=canonical href=https://blog.adelaideb9.com/posts/2022/uactf/evil-eval/><link crossorigin=anonymous href=/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe+FVUFzPh7U=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://blog.adelaideb9.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.adelaideb9.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.adelaideb9.com/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.adelaideb9.com/apple-touch-icon.png><link rel=mask-icon href=https://blog.adelaideb9.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css integrity=sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js integrity=sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4 crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js integrity=sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa crossorigin=anonymous onload='renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"\\[",right:"\\]",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1}]})'></script><meta property="og:title" content="Evil Eval - UACTF 2022"><meta property="og:description" content="Made a cool internet calculator for all your maths needs. Well, some of your maths needs."><meta property="og:type" content="article"><meta property="og:url" content="https://blog.adelaideb9.com/posts/2022/uactf/evil-eval/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-08-07T00:00:00+00:00"><meta property="article:modified_time" content="2022-08-07T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Evil Eval - UACTF 2022"><meta name=twitter:description content="Made a cool internet calculator for all your maths needs. Well, some of your maths needs."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.adelaideb9.com/posts/"},{"@type":"ListItem","position":2,"name":"Evil Eval - UACTF 2022","item":"https://blog.adelaideb9.com/posts/2022/uactf/evil-eval/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Evil Eval - UACTF 2022","name":"Evil Eval - UACTF 2022","description":"Made a cool internet calculator for all your maths needs. Well, some of your maths needs.","keywords":[],"articleBody":"Trying a variety of inputs over netcat, you’ll quickly discover two key pieces of information from the error messages:\nThe characters ‘f’, ’l’, ‘a’, ‘g’, ‘.’, ’t’, ‘x’, ’t’, and ‘`’ are all blocked Our input can’t have more than eight distinct characters We can infer that our goal is something to the effect of making a system call like cat flag.txt in eight or fewer characters. Looking through Ruby’s pre-defined variables, we can see that $\" denotes a long list of module names (loaded by require) which we can potentially character index and frankenstein together to write out “flag.txt” in relatively few distinct characters, like so:\nf -\u003e $\"[11+1+1+1][11+11+11] l -\u003e $\"[1+1+1][1+1+1+1] a -\u003e $\"[1+1][1] g -\u003e $\"[11][11+11+1+1] . -\u003e $\"[1][1+1+1+1+1+1] t -\u003e $\"[1+1][1+1] x -\u003e $\"[1+1+1][1+1+1+1+1+1] t -\u003e $\"[1+1][1+1] The next step is to get Ruby to print the contents of this file. One trick is to pass ARGV \u003c\u003c flag.txt, which will cause our ruby script to call itself, passing the evaluated contents of flag.txt to itself, exposing the flag. Of course, this requires two many distinct characters, but by referring back to our trusty pre-defined variables, we see that the much shorter $* is an alias to ARGV. Putting all this information, we can create the following ‘payload’ to expose the flag:\n$*\u003c\u003c$\"[11+1+1+1][11+11+11]+$\"[1+1+1][1+1+1+1]+$\"[1+1][1]+$\"[11][11+11+1+1]+$\"[1][1+1+1+1+1+1]+$\"[1+1][1+1]+$\"[1+1+1][1+1+1+1+1+1]+$\"[1+1][1+1] Flag: UACTF{8u7_53210u51y_d0n7_3v41}\n","wordCount":"219","inLanguage":"en","datePublished":"2022-08-07T00:00:00Z","dateModified":"2022-08-07T00:00:00Z","author":{"@type":"Person","name":"javad"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.adelaideb9.com/posts/2022/uactf/evil-eval/"},"publisher":{"@type":"Organization","name":"AdelaideB9 Blog","logo":{"@type":"ImageObject","url":"https://blog.adelaideb9.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.adelaideb9.com/ accesskey=h title="AdelaideB9 Blog (Alt + H)">AdelaideB9 Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://blog.adelaideb9.com/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://blog.adelaideb9.com/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://blog.adelaideb9.com/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://blog.adelaideb9.com/>Home</a>&nbsp;»&nbsp;<a href=https://blog.adelaideb9.com/posts/>Posts</a></div><h1 class=post-title>Evil Eval - UACTF 2022</h1><div class=post-description>Made a cool internet calculator for all your maths needs. Well, some of your maths needs.</div><div class=post-meta><span title='2022-08-07 00:00:00 +0000 UTC'>August 7, 2022</span>&nbsp;·&nbsp;javad</div></header><div class=post-content><p>Trying a variety of inputs over netcat, you&rsquo;ll quickly discover two key pieces of information from the error messages:</p><ol><li>The characters &lsquo;f&rsquo;, &rsquo;l&rsquo;, &lsquo;a&rsquo;, &lsquo;g&rsquo;, &lsquo;.&rsquo;, &rsquo;t&rsquo;, &lsquo;x&rsquo;, &rsquo;t&rsquo;, and &lsquo;`&rsquo; are all blocked</li><li>Our input can&rsquo;t have more than eight distinct characters</li></ol><p>We can infer that our goal is something to the effect of making a system call like <code>cat flag.txt</code> in eight or fewer characters. Looking through <a href=https://ruby-doc.org/docs/ruby-doc-bundle/Manual/man-1.4/variable.html>Ruby&rsquo;s pre-defined variables</a>, we can see that <code>$"</code> denotes a long list of module names (loaded by require) which we can potentially character index and frankenstein together to write out &ldquo;flag.txt&rdquo; in relatively few distinct characters, like so:</p><pre tabindex=0><code>f -&gt; $&#34;[11+1+1+1][11+11+11]
l -&gt; $&#34;[1+1+1][1+1+1+1]
a -&gt; $&#34;[1+1][1]
g -&gt; $&#34;[11][11+11+1+1]
. -&gt; $&#34;[1][1+1+1+1+1+1]
t -&gt; $&#34;[1+1][1+1]
x -&gt; $&#34;[1+1+1][1+1+1+1+1+1]
t -&gt; $&#34;[1+1][1+1]
</code></pre><p>The next step is to get Ruby to print the contents of this file. One trick is to pass <code>ARGV &lt;&lt; flag.txt</code>, which will cause our ruby script to call itself, passing the evaluated contents of <code>flag.txt</code> to itself, exposing the flag. Of course, this requires two many distinct characters, but by referring back to our trusty pre-defined variables, we see that the much shorter <code>$*</code> is an alias to <code>ARGV</code>. Putting all this information, we can create the following &lsquo;payload&rsquo; to expose the flag:</p><pre tabindex=0><code>$*&lt;&lt;$&#34;[11+1+1+1][11+11+11]+$&#34;[1+1+1][1+1+1+1]+$&#34;[1+1][1]+$&#34;[11][11+11+1+1]+$&#34;[1][1+1+1+1+1+1]+$&#34;[1+1][1+1]+$&#34;[1+1+1][1+1+1+1+1+1]+$&#34;[1+1][1+1]
</code></pre><p><strong>Flag:</strong> <code>UACTF{8u7_53210u51y_d0n7_3v41}</code></p></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://blog.adelaideb9.com/>AdelaideB9 Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>